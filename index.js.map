{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["\nconst galleryList = document.querySelector(\".gallery\");\nconst hiddenClass = \"is-hidden\";\n\nclass ButtonService {\n  constructor(buttonEl, hiddenClass) {\n    this.buttonEl = buttonEl;\n    this.hiddenClass = hiddenClass;\n  }\n\n  showLoadMoreButton() {\n    this.buttonEl.classList.remove(this.hiddenClass);\n  }\n\n  hideLoadMoreButton() {\n    this.buttonEl.classList.add(this.hiddenClass);\n  }\n}\n\nclass LoadService {\n  constructor(loader, hiddenClass) {\n    this.loader = loader;\n    this.hiddenClass = hiddenClass;\n  }\n\n  showLoader() {\n    this.loader.classList.remove(this.hiddenClass);\n  }\n\n  hideLoader() {\n    this.loader.classList.add(this.hiddenClass);\n  }\n}\n\n\nfunction createGallery(images) {\n  const markup = images\n      .map(\n        ({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) =>\n            `<li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img \n              class=\"gallery-image\" \n              src=\"${webformatURL}\" \n              alt=\"${tags}\" \n            />\n          </a>\n          \n          <ul class=\"image-description\">\n          <li class=\"image-description-item\">Likes <span class=\"description-numbers\">${likes}</span></li>\n          <li class=\"image-description-item\">Views <span class=\"description-numbers\">${views}</span></li>\n          <li class=\"image-description-item\">Comments <span class=\"description-numbers\">${comments}</span></li>\n          <li class=\"image-description-item\">Download <span class=\"description-numbers\">${downloads}</span></li>\n          </ul>\n        </li>`\n      )\n    .join('');\n\n  galleryList.insertAdjacentHTML('beforeend', markup);\n}\n\nfunction clearGallery() {\n  galleryList.innerHTML = '';\n}\n\nexport { ButtonService, LoadService, createGallery, clearGallery };","import axios from 'axios';\n\nconst BASE_URL = \"https://pixabay.com/api\";\nconst API_KEY = \"52901164-552010a54c9c54893e8a3cd4c\";\n\naxios.defaults.baseURL = BASE_URL;\n\nfunction getImagesByQuery({ page = 1, per_page = 20, q = \"\" } = {}) {\n    return axios\n    .get(\"/\", {\n         params: {\n        page,\n        per_page,\n        q,\n        key: API_KEY,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n         },\n    }).then(({ data }) => data);\n}\n\nexport default getImagesByQuery;","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport * as RenderFunctions from \"./js/render-functions.js\";\nimport getImagesByQuery from \"./js/pixabay-api.js\"\n\nconst form = document.querySelector(\".form\");\nconst galleryList = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader\");\nconst buttonEl = document.querySelector('[data-action=\"load-more\"]');\n\n\nconst params = {\n    page: 1, \n    per_page: 15,\n    q: \"\",\n    maxPage: 0,\n};\n\nconst loadMoreBtn = new RenderFunctions.ButtonService(buttonEl, \"is-hidden\");\nloadMoreBtn.hideLoadMoreButton();\n\nconst loaderMore = new RenderFunctions.LoadService(loader, \"is-hidden\");\nloaderMore.hideLoader();\n\n// --- Инициализация SimpleLightbox ---\nlet gallery = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionDelay: 250,\n});\n\nfunction getGalleryImageHeight() {\n  const firstImage = document.querySelector('.gallery-image');\n  if (!firstImage) return 0;\n  const { height } = firstImage.getBoundingClientRect();\n  return height;\n}\n\nasync function smoothScrollByImageHeight(multiplier = 2) {\n\n    await new Promise(resolve => requestAnimationFrame(resolve));\n\n  const imgHeight = getGalleryImageHeight();\n  if (imgHeight > 0) {\n    window.scrollBy({\n      top: imgHeight * multiplier,\n      behavior: 'smooth',\n    });\n  }\n}\n\n// --- Слушатель формы ---\nform.addEventListener(\"submit\", handleSearch);\nbuttonEl.addEventListener(\"click\", handleLoadMore);\n\nasync function handleSearch(event) {\n        event.preventDefault();\n        RenderFunctions.clearGallery();\n\nconst form = event.currentTarget;\nparams.q = form.elements.search.value.trim();\n\nif (!params.q) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Write a request',\n      position: 'topRight',\n    });\n    form.reset();\n    return;\n}\n\nloaderMore.showLoader();\nloadMoreBtn.hideLoadMoreButton();\n\n    try {\nconst { hits, total } = await getImagesByQuery(params);\n\nparams.maxPage = Math.ceil( total / params.per_page);\nconst images = hits;\n\nif (images.length === 0) {\n    loaderMore.hideLoader();\n      loadMoreBtn.hideLoadMoreButton();\n    iziToast.error({\n         title: 'Error',\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight', \n      });\n      return; // прерываем выполнение\n}\n\nRenderFunctions.createGallery(images);\ngallery.refresh();\n\n// плавна прокрутка вниз на дві висоти картинки\nawait smoothScrollByImageHeight();\n\nloaderMore.hideLoader(); \n\nif(params.maxPage > 1) {\n    loadMoreBtn.showLoadMoreButton();\n\n} else {\n        loadMoreBtn.hideLoadMoreButton();\n}\n\n}\ncatch (err) {\n    iziToast.error({\n      title: 'Error',\n      message: `There is a problem during query ${err}`,\n      position: 'topRight',\n    });\n} finally {\n        form.reset();\n}\n}\n\nasync function handleLoadMore() {\n    params.page += 1; \n    loaderMore.showLoader();\n    loadMoreBtn.hideLoadMoreButton();\n\n    try {\nconst { hits } = await getImagesByQuery(params);\n\nRenderFunctions.createGallery(hits);\ngallery.refresh();\n\n// плавна прокрутка вниз на дві висоти картинки\nawait smoothScrollByImageHeight();\n\n    }\n    catch(err) {\n      iziToast.error({\n      title: \"Error\",\n      message: `There is a problem during query ${err}`,\n      position: \"topRight\",\n    }); \n    } finally  {\n        loaderMore.hideLoader();\n        if(params.page === params.maxPage) {\n            loadMoreBtn.hideLoadMoreButton();\n            buttonEl.removeEventListener(\"click\", handleLoadMore);\n        } else {\n            loadMoreBtn.showLoadMoreButton();\n        }\n    }\n} \n\n\n\n\n\n"],"names":["galleryList","ButtonService","buttonEl","hiddenClass","LoadService","loader","createGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","BASE_URL","API_KEY","axios","getImagesByQuery","page","per_page","q","data","form","params","loadMoreBtn","RenderFunctions.ButtonService","loaderMore","RenderFunctions.LoadService","gallery","SimpleLightbox","getGalleryImageHeight","firstImage","height","smoothScrollByImageHeight","multiplier","resolve","imgHeight","handleSearch","handleLoadMore","event","RenderFunctions.clearGallery","iziToast","hits","total","RenderFunctions.createGallery","err"],"mappings":"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"}